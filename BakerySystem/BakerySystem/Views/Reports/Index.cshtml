
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<link href="https://cdn.datatables.net/1.10.15/css/dataTables.bootstrap.min.css" rel="stylesheet" />
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" />

<script src="//cdn.datatables.net/1.10.15/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.10.15/js/dataTables.bootstrap.min.js"></script>
<style>
    .errorClass {
        border: 1px solid red;
        border-width: 3px;
    }
    select {
        -webkit-appearance: none;
        -moz-appearance: none;
        outline: 0;
        box-shadow: none;
        border: 0 !important;
        background: #2c3e50;
        background-image: none;
    }
    /* Custom Select */
    .select {
        position: relative;
        display: block;
        width: 20em;
        height: 3em;
        line-height: 3;
        background: #2c3e50;
        overflow: hidden;
        border-radius: .25em;
    }

    select {
        width: 100%;
        height: 100%;
        margin: 0;
        padding: 0 0 0 .5em;
        color: #fff;
        cursor: pointer;
    }

        select::-ms-expand {
            display: none;
        }
    /* Arrow */
    .select::after {
        content: '\25BC';
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        padding: 0 1em;
        background: #34495e;
        pointer-events: none;
    }
    /* Transition */
    .select:hover::after {
        color: #f39c12;
    }

    .select::after {
        -webkit-transition: .25s all ease;
        -o-transition: .25s all ease;
        transition: .25s all ease;
    }
</style>
<h2>Reports</h2>

<div>
    <div id="controls">
        <label>Please Select Report Type</label> <br>
        <div class="select" style="width:200px;">
            <select id="rpttype" name="nm_rpttype">
                <option value="0" selected>Report Type</option>
                <option value="1">Admin login Details</option>
                <option value="2">Order Details</option>
                <option value="3">Item Details</option>
            </select>
        </div><br>
        <label>Date From</label> <br>
        <input type="text" id="dtfrom" class="datepicker btn-outline-primary" name="nm_dtfrom">
        <br>
        <label>Date To</label> <br>
        <input type="text" id="dtTo" class="datepicker btn-outline-primary" name="nm_dtTo">
        <br><br>
        <input type="button" id="search" value="Search" class="btn btn-outline-primary" onclick="Search()">
        <br>
    </div>
    <div id="ReportDiv">
        <table id="ReportTable" class="table table-striped table-bordered" style="width:100%"></table>
    </div>
</div>

<div id="DeliveryDetails">


</div>
<script>
    $(function () { // will trigger when the document is ready
        $('.datepicker').datepicker(); //Initialise any date pickers
    });
    var Popup, dataTable;
    function Search() {
        var html = '';
        if ($('#rpttype').val() == 0) {
            $('#rpttype').addClass('errorClass');
            setTimeout(function () {
                $('#rpttype').removeClass('errorClass');
            }, 1000);
            return;
        }
        else if ($('#dtfrom').val() == '') {

            $('#dtfrom').addClass('errorClass');
            setTimeout(function () {
                $('#dtfrom').removeClass('errorClass');
            }, 1000);
            return;
        }
        else if ($('#dtTo').val() == '') {

            $('#dtTo').addClass('errorClass');
            setTimeout(function () {
                $('#dtTo').removeClass('errorClass');
            }, 1000);
            return;
        }
        else if ($('#rpttype').val() == 1) {
            $('#ReportDiv').hide();
            $('#ReportDiv').empty();
            html = '<table id="ReportTable" class="table table-striped table-bordered" style="width:100%"><thead><tr><th>Id</th><th>User Name</th><th>MachineIP</th><th>OperatingSystem</th><th>LoginTime</th></tr></thead></table >'
            $('#ReportDiv').append(html);
            dataTable = $("#ReportTable").DataTable({
                "ajax": {
                    "url": "/Reports/GetReport",
                    "type": "Get",
                    "data": function (d) {
                        d.nm_rpttype = $('#rpttype').val();
                        d.nm_dtfrom = new Date($('#dtfrom').val()).toISOString().slice(0, 10);
                        d.nm_dtTo = new Date($('#dtTo').val()).toISOString().slice(0, 10);
                        // etc
                    },
                    "datatype": "json"
                },
                "columns": [
                    { "data": "Id" },
                    { "data": "UserName" },
                    { "data": "MachineIP" },
                    { "data": "OperatingSystem" },
                    { "data": "LoginTime" }
                ],
                "language": {

                    "emptyTable": "No data found"
                }
            });
        }
        else if ($('#rpttype').val() == 2) {
            $('#ReportDiv').hide();
            $('#ReportDiv').empty();
            html = '<table id="ReportTable" class="table table-striped table-bordered" style="width:100%"><thead><tr><th>Order #</th><th>personname</th><th>address</th><th>postCode</th><th>Order on</th><th>Delivered</th><th>PaymentType</th></tr></thead></table >'
            $('#ReportDiv').append(html);
            dataTable = $("#ReportTable").DataTable({
                "ajax": {
                    "url": "/Reports/GetReport",
                    "type": "Get",
                    "data": function (d) {
                        d.nm_rpttype = $('#rpttype').val();
                        d.nm_dtfrom = new Date($('#dtfrom').val()).toISOString().slice(0, 10);
                        d.nm_dtTo = new Date($('#dtTo').val()).toISOString().slice(0, 10);
                        // etc
                    },
                    "datatype": "json"
                },
                "columns": [
                    { "data": "OrderId" },
                    { "data": "personname" },
                    { "data": "address" },
                    { "data": "postCode" },
                    { "data": "add_dtee" },
                    { "data": "Delivered" },
                    { "data": "PaymentType" }
                ],
                "language": {

                    "emptyTable": "No data found"
                }
            });
        }
        else if ($('#rpttype').val() == 3) {
            $('#ReportDiv').hide();
            $('#ReportDiv').empty();
            html = '<table id="ReportTable" class="table table-striped table-bordered" style="width:100%"><thead><tr><th>Item Name</th><th>Item Price</th><th>Image</th><th>Expiry Date</th></tr></thead></table>'
            $('#ReportDiv').append(html);
            $("#ReportTable").DataTable({
                "ajax": {
                    "url": "/Reports/GetReport/",
                    "type": "GET",
                    "data": function (d) {
                        d.nm_rpttype = $('#rpttype').val();
                        d.nm_dtfrom = new Date($('#dtfrom').val()).toISOString().slice(0, 10);
                        d.nm_dtTo = new Date($('#dtTo').val()).toISOString().slice(0, 10);
                        // etc
                    },
                    "datatype": "json"
                },
                "columns": [
                    { "data": "name" },
                    { "data": "price" },
                    { "data": "Id", "render": function (data) { return '<img style="width:70px;height:70px;" src="' + "/Home/getImage2/" + data + '" />'; } },
                    { "data": "expiry_dte" }
                ],
                "language": {

                    "emptyTable": "No data found, Please click on <b>Add New</b> Button"
                }

            });
        }

        $(".dataTables_filter").hide();
        $(".dataTables_info").hide();
        $(".dataTables_length").hide();
        $('.dataTables_paginate paging_simple_numbers').hide();
        $('#ReportDiv').show();

    }
</script>

